<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plastic-shooter - Version de Base</title>

  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      background: #a2ded0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column; 
      height: 100vh;
      text-align: center;  
    }

    canvas {
      background: url("/template/image/8bit_beach_loop.gif") no-repeat center center;
      background-size: cover;
      box-shadow: 0 0 10px tortue;
      border-radius: 10px;
    }

    body {
      font-family: 'Press Start 2P', cursive;
    }

    canvas {
      font-family: 'Press Start 2P', cursive;
    }

    h1 {
      font-size: 40px; 
      margin-bottom: 20px; 
      color: #ffffff;  
    }
  </style>
</head>
<body>
  <h1>Plastic-shooter</h1>
  
  <canvas id="gameCanvas" width="800" height="600"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const imgChips = new Image();
    imgChips.src = "/template/image/chips.png";
    const imgSac = new Image();
    imgSac.src = "/template/image/plastique.png";
    const imgBouteille = new Image();
    imgBouteille.src = "/template/image/bouteil.png";
    const imgGant = new Image();
    imgGant.src = "/template/image/gant.png";
    const imgGoblet = new Image();
    imgGoblet.src = "/template/image/goblet.png";
    const imgTortue = new Image();
    imgTortue.src = "/template/image/tortue.png"; 

    function getImageByType(type) {
      switch (type) {
        case "chips": return imgChips;
        case "sac": return imgSac;
        case "bouteille": return imgBouteille;
        case "gant": return imgGant;
        case "goblet": return imgGoblet;
        default: return imgChips;
      }
    }

    let bullets = [];
    let enemies = [];
    let mouseX = 400, mouseY = 300;
    let lastEnemySpawn = 0;
    let score = 0;

    canvas.addEventListener("mousemove", e => {
      const rect = canvas.getBoundingClientRect();
      mouseX = e.clientX - rect.left;
      mouseY = e.clientY - rect.top;
    });

    canvas.addEventListener("click", () => {
      bullets.push({ x: 400, y: 550, dx: (mouseX - 400) / 20, dy: (mouseY - 550) / 20 });
    });

    function spawnEnemy() {
      const types = ["chips", "sac", "bouteille", "gant", "goblet"];
      const type = types[Math.floor(Math.random() * types.length)];
      enemies.push({ x: Math.random() * 740, y: -60, speed: 1 + Math.random(), type, width: 50, height: 50 });
    }

    function drawEnemy(e) {
      const image = getImageByType(e.type);
      ctx.drawImage(image, e.x, e.y, e.width, e.height);
    }

    function drawBullet(bullet) {
      ctx.fillStyle = "#00ffcc";
      ctx.beginPath();
      ctx.arc(bullet.x, bullet.y, 5, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawScore() {
      ctx.fillStyle = "#ffffff";
      ctx.font = "24px 'Press Start 2P'"; // Appliquer la police ici
      ctx.fillText("Score : " + score, 20, 40);
    }

    function updateGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Dessine l'image de la tortue
      ctx.drawImage(imgTortue, 380, 540, 40, 60);  // Remplace le rectangle par l'image

      // Ligne de visÃ©e
      ctx.strokeStyle = "#00ffcc";
      ctx.beginPath();
      ctx.moveTo(400, 550);
      ctx.lineTo(mouseX, mouseY);
      ctx.stroke();

      // Bullets
      bullets.forEach((b, i) => {
        b.x += b.dx;
        b.y += b.dy;
        drawBullet(b);
        if (b.y < 0 || b.x < 0 || b.x > 800) bullets.splice(i, 1);
      });

      if (Date.now() - lastEnemySpawn > 1000) {
        spawnEnemy();
        lastEnemySpawn = Date.now();
      }

      enemies.forEach((e, i) => {
        e.y += e.speed;
        drawEnemy(e);

        bullets.forEach((b, j) => {
          if (
            b.x >= e.x && b.x <= e.x + e.width &&
            b.y >= e.y && b.y <= e.y + e.height
          ) {
            enemies.splice(i, 1);
            bullets.splice(j, 1);
            score += 10;
          }
        });

        if (e.y > canvas.height) {
          enemies.splice(i, 1);
          score -= 5; 
        }
      });

      drawScore();
      requestAnimationFrame(updateGame);
    }

    updateGame();
  </script>
</body>
</html>
